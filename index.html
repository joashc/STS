<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8"/>
	<title>Sequential Trial Simulator</title>

	<link href="src/bootstrap.css" rel="stylesheet">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	<script type="text/javascript" src="src/ramda.min.js"></script>
	<script type="text/javascript" src="src/webScript.js"></script>
	<script src="http://d3js.org/d3.v3.min.js"></script>
	<script src="src/jstat.min.js"></script>
	<script src="src/ramda.min.js"></script>
	<script src="src/stage.js"></script>
	<script src="src/sts.js"></script>
	<script src="src/bootstrap.js"></script>
</head>

<body>
	<div class="jumbotron">
		<h1>Sequential Trial Simulator</h1>
		<p>A tool for simulating drug trials.</p>
	</div>
	
	<div class="container-fluid">
		<div class="row-fluid">
			<div id="message"></div>
			

		<div class="col-sm-12" id="trialString">
			<form id="trialDesign" class="form-horizontal"
			    data-fv-framework="bootstrap"
			    data-fv-icon-valid="glyphicon glyphicon-ok"
			    data-fv-icon-invalid="glyphicon glyphicon-remove"
			    data-fv-icon-validating="glyphicon glyphicon-refresh">

				<h2>Trial string</h2>
				<ul id="trialSim" class="list-inline"></ul>
				<button id="start">Start</button>
			</form>
		</div>
		

		<!-- Output graphs div -->
		<div class="row-fluid">
			<div class="col-sm-12" id="output">
				<h2>Output graphs</h2>

				<div class="col-sm-5" id="area1">
	                <svg id="visualisation" width="400" height="270"></svg>

			 		<script>
var graphTrGivenS = function (data) {
						var firstData = R.last(data);
						var lastData = R.head(data);
						var trueRate = R.prop('trueRate');
						var trGivenS  = R.prop('trGivenS');
						var firstTrueRate = trueRate(firstData);
						var lastTrueRate = trueRate(lastData);
						var firstTrGivenS = trGivenS(firstData);
						var lastTrGivenS = trGivenS(lastData);

						var vis = d3.select("#visualisation"),
						    WIDTH = 400,
						    HEIGHT = 270,
						    MARGINS = {
						        top: 20,
						        right: 20,
						        bottom: 20,
						        left: 50
						    },

					    xScale = d3.scale.linear().range([MARGINS.left, WIDTH - MARGINS.right]).domain([firstTrueRate,lastTrueRate]),
					    yScale = d3.scale.linear().range([HEIGHT - MARGINS.top, MARGINS.bottom]).domain([lastTrGivenS, firstTrGivenS]),

					    xAxis = d3.svg.axis()
						    .scale(xScale),
						  
						yAxis = d3.svg.axis()
						    .scale(yScale)
			    			.orient("left");

					    vis.append("svg:g")
						    .attr("transform", "translate(0," + (HEIGHT - MARGINS.bottom) + ")")
						    .call(xAxis);
					    vis.append("svg:g")
						    .attr("transform", "translate(" + (MARGINS.left) + ",0)")
						    .call(yAxis);

					    var lineGen = d3.svg.line()
							.x(function(d) {
							return xScale(d.trueRate);
							})
							.y(function(d) {
							return yScale(d.trGivenS);
							});

						vis.append('svg:path')
						  .attr('d', lineGen(data));

						var lineGen = d3.svg.line()
						    .x(function(d) {
						        return xScale(d.year);
						    })
						    .y(function(d) {
						        return yScale(d.sale);
						    })
						    .interpolate("basis");
};
			 		</script>
			 		
				<div class="col-sm-5" id="area2">
				</div>
			</div>
		</div>
	</div>

	<footer>
		<div class="container">
	    	<p>STS for Health Hack 2015. &copy; 2015</p>
	    	<p>
		    	<a href="#">Back to top</a>
	    	</p>
	    </div>
    </footer>
</body>
</html>
